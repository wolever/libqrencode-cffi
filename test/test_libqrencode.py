import libqrencode as qr

def test_version():
    assert qr.api_version_string() == b"3.4.4"
    assert qr.api_version() == (3, 4, 4)

def test_qrcode_simple():
    expected = [
        193, 193, 193, 193, 193, 193, 193, 192, 132, 3, 2, 3, 3, 192, 193, 193,
        193, 193, 193, 193, 193, 193, 192, 192, 192, 192, 192, 193, 192, 132,
        3, 3, 3, 2, 192, 193, 192, 192, 192, 192, 192, 193, 193, 192, 193, 193,
        193, 192, 193, 192, 133, 3, 2, 3, 3, 192, 193, 192, 193, 193, 193, 192,
        193, 193, 192, 193, 193, 193, 192, 193, 192, 132, 3, 2, 3, 2, 192, 193,
        192, 193, 193, 193, 192, 193, 193, 192, 193, 193, 193, 192, 193, 192,
        132, 2, 3, 2, 3, 192, 193, 192, 193, 193, 193, 192, 193, 193, 192, 192,
        192, 192, 192, 193, 192, 132, 2, 2, 2, 3, 192, 193, 192, 192, 192, 192,
        192, 193, 193, 193, 193, 193, 193, 193, 193, 192, 145, 144, 145, 144,
        145, 192, 193, 193, 193, 193, 193, 193, 193, 192, 192, 192, 192, 192,
        192, 192, 192, 133, 3, 2, 3, 3, 192, 192, 192, 192, 192, 192, 192, 192,
        133, 133, 133, 132, 133, 133, 145, 133, 133, 3, 3, 3, 2, 133, 133, 132,
        132, 132, 133, 132, 132, 2, 3, 3, 3, 3, 2, 144, 3, 2, 2, 2, 2, 2, 2, 3,
        3, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2, 2, 145, 2, 3, 2, 3, 2, 3, 2, 2, 2, 3,
        3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 144, 3, 2, 3, 2, 2, 2, 2, 3, 3, 3, 2, 2,
        3, 2, 2, 2, 2, 2, 2, 2, 145, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2,
        192, 192, 192, 192, 192, 192, 192, 192, 129, 3, 3, 3, 2, 3, 2, 2, 3, 2,
        3, 3, 3, 193, 193, 193, 193, 193, 193, 193, 192, 133, 2, 2, 3, 2, 3, 3,
        2, 3, 2, 2, 3, 3, 193, 192, 192, 192, 192, 192, 193, 192, 133, 2, 2, 3,
        3, 3, 2, 3, 3, 2, 2, 2, 3, 193, 192, 193, 193, 193, 192, 193, 192, 133,
        2, 2, 3, 2, 3, 3, 2, 3, 3, 2, 3, 3, 193, 192, 193, 193, 193, 192, 193,
        192, 132, 3, 3, 2, 2, 2, 3, 2, 3, 2, 2, 3, 2, 193, 192, 193, 193, 193,
        192, 193, 192, 133, 2, 2, 2, 3, 2, 2, 3, 3, 2, 3, 2, 3, 193, 192, 192,
        192, 192, 192, 193, 192, 133, 3, 3, 2, 2, 2, 3, 2, 2, 2, 2, 3, 2, 193,
        193, 193, 193, 193, 193, 193, 192, 133, 2, 3, 2, 3, 2, 3, 3, 3, 2, 2,
        3, 3,
    ]
    qrc = qr.QRCode(b"hunter2")
    assert qrc.get_raw_data() == expected

def test_get_xml():
    qrc = qr.QRCode(b"12345", mode=qr.MODE_NUM)
    bytes = qrc.get_svg_string()
    expected = (
        b'<g><rect fill="white" height="21" width="21" x="0" y="0" />'
        b'<rect fill="black" height="1" width="1" x="0" y="0" />'
        b'<rect fill="black" height="1" width="1" x="0" y="1" />'
    )
    assert bytes[:len(expected)] == expected
